# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ10: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∏ –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

**Astana IT University**

**–ö—É—Ä—Å:** Heterogeneous Parallelization

**–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:** –°–∞–¥–≤–∞–∫–∞—Å–æ–≤–∞ –ö—É—Ä–∞–ª–∞–π –ñ–∞–Ω–∂–∏–≥–∏—Ç–æ–≤–Ω–∞

**–°—Ç—É–¥–µ–Ω—Ç:** –ñ—É–º–∞–≥—É–ª–æ–≤–∞ –ö–∞—Ä–∏–Ω–∞

**–ì—Ä—É–ø–ø–∞:** ADA-2403M

**–î–∞—Ç–∞:** 25.01.2026

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã

–î–∞–Ω–Ω–∞—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ—Å–≤—è—â–µ–Ω–∞ **–∞–Ω–∞–ª–∏–∑—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º**, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:

* **OpenMP** (CPU-–ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º),
* **CUDA** (GPU-–≤—ã—á–∏—Å–ª–µ–Ω–∏—è),
* **MPI** (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è),
* **–≥–∏–±—Ä–∏–¥–Ω—ã—Ö CPU + GPU —Ä–µ—à–µ–Ω–∏–π**.

–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å —Ä–∞–±–æ—Ç—ã ‚Äî –∏–∑—É—á–∏—Ç—å, **–∫–∞–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –¥–æ—Å—Ç—É–ø –∫ –ø–∞–º—è—Ç–∏ –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É CPU –∏ GPU –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**, –∞ —Ç–∞–∫–∂–µ –Ω–∞—É—á–∏—Ç—å—Å—è –≤—ã—è–≤–ª—è—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

–í —Ä–∞–º–∫–∞—Ö —Ä–∞–±–æ—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ç—ã—Ä–µ –∑–∞–¥–∞–Ω–∏—è:

1. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ CPU-–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (OpenMP).
2. –ê–Ω–∞–ª–∏–∑ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏ –Ω–∞ GPU (CUDA).
3. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è CPU + GPU.
4. –ê–Ω–∞–ª–∏–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (MPI).

–î–ª—è –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π:

* –≤—ã–ø–æ–ª–Ω–µ–Ω—ã **–∑–∞–º–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**,
* –ø—Ä–æ–≤–µ–¥–µ–Ω–æ **–ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π**,
* —Å–¥–µ–ª–∞–Ω—ã –≤—ã–≤–æ–¥—ã –æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ —É–∑–∫–∏—Ö –º–µ—Å—Ç–∞—Ö.

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

* –ò–∑—É—á–∏—Ç—å –º–µ—Ç–æ–¥—ã **–ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º**.
* –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ —á–∏—Å–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ.
* –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å **–Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö** –º–µ–∂–¥—É CPU –∏ GPU.
* –û—Å–≤–æ–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏ (coalesced access, shared memory, pinned memory).
* –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è **–∑–∞–∫–æ–Ω–æ–≤ –ê–º–¥–∞–ª–∞ –∏ –ì—É—Å—Ç–∞—Ñ—Å–æ–Ω–∞**.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
.
‚îú‚îÄ‚îÄ task_1_openmp.cpp        # OpenMP: –∞–Ω–∞–ª–∏–∑ CPU-–ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞
‚îú‚îÄ‚îÄ task_2_cuda_memory.cu    # CUDA: –¥–æ—Å—Ç—É–ø –∫ –ø–∞–º—è—Ç–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ task_3_hybrid.cu         # –ì–∏–±—Ä–∏–¥–Ω–æ–µ CPU + GPU –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ task_4_mpi.cpp           # MPI: strong –∏ weak scaling
‚îú‚îÄ‚îÄ questions.md             # –û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
‚îú‚îÄ‚îÄ README.md                # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º

**–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∏–∑–º–µ—Ä–µ–Ω–∏—è:

* –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —á–∞—Å—Ç–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã,
* –∑–∞–≥—Ä—É–∑–∫–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤,
* –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö.

–í –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:

* `omp_get_wtime()` ‚Äî –¥–ª—è CPU (OpenMP),
* `cudaEventRecord()` ‚Äî –¥–ª—è GPU,
* `MPI_Wtime()` ‚Äî –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º.

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

## –ó–∞–¥–∞–Ω–∏–µ 1: –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ CPU-–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (OpenMP)

**–¶–µ–ª—å:**
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –º–∞—Å—Å–∏–≤–∞ –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenMP –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ —á–∏—Å–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ.

**–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

* –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—É–º–º—ã, —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –±–æ–ª—å—à–æ–≥–æ –º–∞—Å—Å–∏–≤–∞.
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–∏–≤ `#pragma omp parallel for`.
* –ó–∞–º–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é `omp_get_wtime()`.

**–ê–Ω–∞–ª–∏–∑:**

* –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –¥–æ–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —á–∞—Å—Ç–∏.
* –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–æ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω–æ–º —á–∏—Å–ª–µ –ø–æ—Ç–æ–∫–æ–≤.
* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è **–∑–∞–∫–æ–Ω–∞ –ê–º–¥–∞–ª–∞**.

**–í—ã–≤–æ–¥—ã:**

* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–µ–ª–∞.
* –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ.

–û—Ç–ª–∏—á–Ω–æ, —ç—Ç–æ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–µ –∏ –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã üëç
–î–∞–≤–∞–π –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –æ—Ñ–æ—Ä–º–∏–º **—Ç–∞–±–ª–∏—Ü—ã –¥–ª—è README.md** –≤ Markdown-—Ñ–æ—Ä–º–∞—Ç–µ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ–≥–æ –æ–±—ã—á–Ω–æ –∂–¥—É—Ç –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏.

–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é **–ø–æ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –Ω–∞ –∫–∞–∂–¥–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤**, —á—Ç–æ–±—ã –±—ã–ª–æ —á–∏—Ç–∞–±–µ–ª—å–Ω–æ –∏ –ª–æ–≥–∏—á–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ strong scaling.

### –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞

* –Ø–∑—ã–∫: C++
* –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å: OpenMP
* –ó–∞–º–µ—Ä –≤—Ä–µ–º–µ–Ω–∏: `omp_get_wtime()`
* –î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π: `[-100, 100]`
* –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤: `1, 2, 4, 8`

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

#### OpenMP threads = 1

| –†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ | Sequential time (s) | Parallel time (s) | Total time (s) | Sequential fraction | Parallel fraction |
| -------------- | ------------------- | ----------------- | -------------- | ------------------- | ----------------- |
| 10             | 1.19e-06            | 1.58e-04          | 1.59e-04       | 0.0075              | 0.9925            |
| 100            | 9.06e-06            | 1.50e-05          | 2.41e-05       | 0.3762              | 0.6238            |
| 1 000          | 1.22e-04            | 1.72e-05          | 1.39e-04       | 0.8767              | 0.1233            |
| 10 000         | 1.32e-03            | 1.41e-04          | 1.46e-03       | 0.9032              | 0.0968            |
| 100 000        | 1.12e-02            | 2.05e-03          | 1.33e-02       | 0.8454              | 0.1546            |
| 1 000 000      | 1.04e-01            | 1.30e-02          | 1.17e-01       | 0.8885              | 0.1115            |
| 10 000 000     | 1.18                | 0.130             | 1.31           | 0.9002              | 0.0998            |
| 100 000 000    | 9.99                | 1.75              | 11.74          | 0.8510              | 0.1490            |

#### OpenMP threads = 2

| –†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ | Sequential time (s) | Parallel time (s) | Total time (s) | Sequential fraction | Parallel fraction |
| -------------- | ------------------- | ----------------- | -------------- | ------------------- | ----------------- |
| 10             | 9.54e-07            | 7.97e-04          | 7.98e-04       | 0.0012              | 0.9988            |
| 100            | 7.15e-06            | 2.60e-05          | 3.31e-05       | 0.2158              | 0.7842            |
| 1 000          | 8.51e-05            | 8.70e-05          | 1.72e-04       | 0.4945              | 0.5055            |
| 10 000         | 1.00e-03            | 2.28e-04          | 1.23e-03       | 0.8147              | 0.1853            |
| 100 000        | 1.04e-02            | 9.88e-04          | 1.14e-02       | 0.9136              | 0.0864            |
| 1 000 000      | 9.44e-02            | 7.15e-03          | 0.102          | 0.9296              | 0.0704            |
| 10 000 000     | 0.945               | 0.068             | 1.01           | 0.9327              | 0.0673            |
| 100 000 000    | 9.47                | 1.22              | 10.68          | 0.8862              | 0.1138            |

#### OpenMP threads = 4

| –†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ | Sequential time (s) | Parallel time (s) | Total time (s) | Sequential fraction | Parallel fraction |
| -------------- | ------------------- | ----------------- | -------------- | ------------------- | ----------------- |
| 10             | 9.54e-07            | 3.44e-04          | 3.45e-04       | 0.0028              | 0.9972            |
| 100            | 3.79e-05            | 1.17e-04          | 1.55e-04       | 0.2446              | 0.7554            |
| 1 000          | 8.61e-05            | 1.26e-04          | 2.12e-04       | 0.4056              | 0.5944            |
| 10 000         | 1.07e-03            | 1.78e-04          | 1.24e-03       | 0.8570              | 0.1430            |
| 100 000        | 9.16e-03            | 7.55e-04          | 9.91e-03       | 0.9238              | 0.0762            |
| 1 000 000      | 9.12e-02            | 4.40e-03          | 0.0956         | 0.9540              | 0.0460            |
| 10 000 000     | 0.931               | 0.043             | 0.974          | 0.9559              | 0.0441            |
| 100 000 000    | 10.07               | 0.886             | 10.96          | 0.9192              | 0.0808            |

#### OpenMP threads = 8

| –†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ | Sequential time (s) | Parallel time (s) | Total time (s) | Sequential fraction | Parallel fraction |
| -------------- | ------------------- | ----------------- | -------------- | ------------------- | ----------------- |
| 10             | 1.91e-06            | 7.36e-04          | 7.38e-04       | 0.0026              | 0.9974            |
| 100            | 1.10e-05            | 5.61e-04          | 5.72e-04       | 0.0192              | 0.9808            |
| 1 000          | 2.77e-04            | 4.18e-04          | 6.95e-04       | 0.3986              | 0.6014            |
| 10 000         | 2.78e-03            | 4.58e-04          | 3.24e-03       | 0.8585              | 0.1415            |
| 100 000        | 1.35e-02            | 1.13e-03          | 1.47e-02       | 0.9227              | 0.0773            |
| 1 000 000      | 0.133               | 3.69e-03          | 0.137          | 0.9730              | 0.0270            |
| 10 000 000     | 1.40                | 0.034             | 1.43           | 0.9762              | 0.0238            |
| 100 000 000    | 9.47                | 0.658             | 10.13          | 0.9351              | 0.0649            |



## –ó–∞–¥–∞–Ω–∏–µ 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏ –Ω–∞ GPU (CUDA)

**–¶–µ–ª—å:**
–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ GPU –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

**–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

* –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–≤–µ –≤–µ—Ä—Å–∏–∏ CUDA-—è–¥—Ä–∞:

  * —Å –∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∫ –ø–∞–º—è—Ç–∏;
  * —Å –Ω–µ–∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º.
* –ó–∞–º–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `cudaEvent`.

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **shared memory**.
* –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–≤ –∏ –±–ª–æ–∫–æ–≤.

**–í—ã–≤–æ–¥—ã:**

* –ö–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
* Shared memory —É–º–µ–Ω—å—à–∞–µ—Ç —á–∏—Å–ª–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ –∏ –ø–æ–≤—ã—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

---

## –ó–∞–¥–∞–Ω–∏–µ 3: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è CPU + GPU

**–¶–µ–ª—å:**
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –≥–∏–±—Ä–∏–¥–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —á–∞—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ CPU, –∞ —á–∞—Å—Ç—å ‚Äî –Ω–∞ GPU, –∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ.

**–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

* CPU –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—É–º–º—É –∏ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞.
* GPU –≤—ã—á–∏—Å–ª—è–µ—Ç –¥–∏—Å–ø–µ—Ä—Å–∏—é –º–∞—Å—Å–∏–≤–∞.
* –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:

  * `cudaMemcpyAsync`,
  * `cudaStream`,
  * CUDA events –¥–ª—è —Ä–∞–∑–¥–µ–ª—å–Ω–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏.

**–ü—Ä–æ—Ñ–∏–ª–∏—Ä—É–µ–º—ã–µ —ç—Ç–∞–ø—ã GPU:**

* Host ‚Üí Device (H2D) copy,
* –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ CUDA-—è–¥—Ä–∞,
* Device ‚Üí Host (D2H) copy.

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**

* –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **pinned (page-locked) memory**:

  ```cpp
  cudaMallocHost(&h_data, N * sizeof(float));
  ```
* –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ —Å–Ω–∏–∑–∏—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è:**

```
CPU time (s):        0.000140
H2D time (s):        0.000027
Kernel time (s):     0.000061
D2H time (s):        0.000016
GPU total time (s):  0.000104
Hybrid total time (s): 0.000244
```

**–í—ã–≤–æ–¥—ã:**

* –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä–∏—Ö–æ–¥—è—Ç—Å—è –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö.
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pinned memory —É–º–µ–Ω—å—à–∞–µ—Ç –≤—Ä–µ–º—è H2D –∏ D2H –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.
* –î–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤ CPU –±—ã—Å—Ç—Ä–µ–µ, –¥–ª—è –±–æ–ª—å—à–∏—Ö ‚Äî GPU –¥–∞—ë—Ç –≤—ã–∏–≥—Ä—ã—à.

---

## –ó–∞–¥–∞–Ω–∏–µ 4: –ê–Ω–∞–ª–∏–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (MPI)

**–¶–µ–ª—å:**
–û—Ü–µ–Ω–∏—Ç—å **strong scaling** –∏ **weak scaling** MPI-–ø—Ä–æ–≥—Ä–∞–º–º—ã.

**–û–ø–∏—Å–∞–Ω–∏–µ:**

* –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–¥ –º–∞—Å—Å–∏–≤–æ–º.
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã `MPI_Reduce` –∏ `MPI_Allreduce`.
* –í—ã–ø–æ–ª–Ω–µ–Ω—ã –∑–∞–º–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω–æ–º —á–∏—Å–ª–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

**–ê–Ω–∞–ª–∏–∑:**

* Strong scaling: —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–¥–∞—á–∏.
* Weak scaling: —Ä–∞–∑–º–µ—Ä –∑–∞–¥–∞—á–∏ —Ä–∞—Å—Ç—ë—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–∏—Å–ª—É –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

**–í—ã–≤–æ–¥—ã:**

* –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.
* MPI —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –±–æ–ª—å—à–∏—Ö –∑–∞–¥–∞—á –∏ —É–º–µ—Ä–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

---

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

–û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ —Ñ–∞–π–ª–µ **questions.md**.

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í —Ö–æ–¥–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª–∏:

* –∏–∑—É—á–µ–Ω—ã –º–µ—Ç–æ–¥—ã –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è CPU, GPU –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º;
* —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∏ –≥–∏–±—Ä–∏–¥–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã;
* –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –∏ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞;
* –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤–ª–∏—è–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –ø–∞–º—è—Ç–∏ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ –¥–∞–ª–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ **HPC-–ø–æ–¥—Ö–æ–¥–æ–≤ –∏ –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π**, –∞ —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑–∞–ª–∞ –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º.

